@if (currentTime$ | async; as now){
  <div class="card-container">
    <div class="route-inputs">
      <div class="current-time input-unified">{{ now | date: 'yyyy-MM-dd HH:mm:ss'}}</div>
      <label class="toggle-switch">
        <input type="checkbox" [formControl]="autoSearchControl">
        <span class="slider"></span>
        <span class="toggle-label">Auto Refresh</span>
      </label>
    </div>
  </div>
    @if (stationDetails && stationDetails.length > 0){
      <ul>
        @for (detail of stationDetails; track detail.id){
          <li class="departure-item">
            <div class="main-info">
              <span class="name">Nach {{ detail.destination }}</span>
              <!-- <span class="name">{{ detail.name }}</span> -->
              <span class="transport-icon">
                @switch (detail.mode){
                  @case ('rail') { 
                    <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 64 64"><path fill="#86613e" d="M63.45 53.623c0 .672-1.126 1.217-2.51 1.217H2.5c-1.385 0-2.508-.545-2.508-1.217l3.154-8.34c0-.672 1.121-1.217 2.505-1.217h52.13c1.385 0 2.508.545 2.508 1.217l3.155 8.34M55.26 36.35c0 .497-.836.904-1.863.904h-43.35c-1.029 0-1.861-.407-1.861-.904l2.34-6.186c0-.499.833-.902 1.859-.902h38.671c1.029 0 1.861.403 1.861.902l2.341 6.186m-5.297-13.3c0 .385-.646.7-1.44.7H14.933c-.792 0-1.44-.315-1.44-.7l1.813-4.794c0-.387.645-.698 1.442-.698h29.961c.794 0 1.44.312 1.44.698l1.812 4.794m-4.481-9.421c0 .29-.486.525-1.089.525H19.063c-.603 0-1.089-.235-1.089-.525l1.369-3.615c0-.293.487-.529 1.085-.529h22.6c.6 0 1.089.235 1.089.529l1.363 3.615"/><path fill="#a87c4f" d="M63.45 52.53c0 .672-1.126 1.215-2.51 1.215H2.5c-1.385 0-2.508-.543-2.508-1.215l3.154-8.339c0-.673 1.121-1.217 2.505-1.217h52.13c1.385 0 2.508.544 2.508 1.217l3.155 8.339M55.26 35.26c0 .497-.836.901-1.863.901h-43.35c-1.029 0-1.861-.404-1.861-.901l2.34-6.188c0-.497.833-.902 1.859-.902h38.671c1.029 0 1.861.405 1.861.902l2.341 6.188m-5.297-13.3c0 .387-.646.7-1.44.7H14.933c-.792 0-1.44-.313-1.44-.7l1.813-4.794c0-.385.645-.698 1.442-.698h29.961c.794 0 1.44.313 1.44.698l1.812 4.794m-4.481-9.424c0 .29-.486.529-1.089.529H19.063c-.603 0-1.089-.239-1.089-.529l1.369-3.615c0-.293.487-.525 1.085-.525h22.6c.6 0 1.089.231 1.089.525l1.363 3.615"/><path fill="#929497" d="M13.1 61.51c-.614 1.875-3.99 2.534-5.949 1.943c-1.959-.589-4.337-2.975-3.723-4.85l20.706-56.11c.615-1.877 1.802-2.921 3.761-2.33c1.957.588 2.146 2.585 1.532 4.462L13.1 61.509"/><path fill="#b1b1b2" d="M9.829 63.45c-1.959-.589-4.337-2.973-3.723-4.85L26.811 2.49c.327-1 .822-1.76 1.504-2.167a2.853 2.853 0 0 0-.419-.164c-1.959-.589-3.146.453-3.761 2.33L3.429 58.599c-.614 1.877 1.764 4.261 3.723 4.85c.84.253 1.935.275 2.965.073a4.329 4.329 0 0 1-.288-.073"/><path fill="#929497" d="M50.26 61.51c.618 1.875 3.99 2.534 5.951 1.943c1.959-.589 4.339-2.975 3.725-4.85L39.228 2.493c-.612-1.877-1.8-2.921-3.759-2.33c-1.959.588-2.146 2.585-1.532 4.462L50.26 61.509"/><path fill="#b1b1b2" d="M53.53 63.45c1.959-.589 4.335-2.973 3.723-4.85L36.545 2.49c-.327-1-.817-1.76-1.5-2.167c.13-.062.266-.12.419-.164c1.959-.589 3.146.453 3.759 2.33l20.708 56.11c.614 1.877-1.766 4.261-3.725 4.85c-.84.253-1.934.275-2.965.073c.098-.02.196-.045.289-.072"/></svg>
                  }
                  @case ('bus') {
                    <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 128 128"><g fill="#2f2f2f"><path d="M117.13 87.29c0 7.35-2.06 13.3-4.58 13.3c-2.53 0-4.58-5.95-4.58-13.3s2.05-13.31 4.58-13.31c2.52 0 4.58 5.97 4.58 13.31z"/><path d="M110.56 99.28s1.22 1.95 2.54 2.61c2.99 1.49 7.15.94 9.65-2.46l-1.34-8.1l-8.46 1.61l-2.39 6.34z"/></g><g fill="#2f2f2f"><path d="M23.71 104.14c0 7.85-2.77 14.22-6.17 14.22c-3.41 0-6.18-6.37-6.18-14.22c0-7.86 2.77-14.23 6.18-14.23c3.4.01 6.17 6.37 6.17 14.23z"/><path d="M14.85 116.97s1.64 2.09 3.44 2.79c4.03 1.59 9.63 1 13-2.62l-1.81-8.66l-11.4 1.72l-3.23 6.77z"/><path d="M34.95 104.14c0 7.85-2.77 14.22-6.17 14.22c-3.41 0-6.18-6.37-6.18-14.22c0-7.86 2.77-14.23 6.18-14.23c3.4.01 6.17 6.37 6.17 14.23z"/></g><g fill="#2f2f2f"><path d="M90.78 104.14c0 7.85-2.77 14.22-6.17 14.22c-3.41 0-6.18-6.37-6.18-14.22c0-7.86 2.77-14.23 6.18-14.23c3.4.01 6.17 6.37 6.17 14.23z"/><path d="M81.92 116.97s1.64 2.09 3.44 2.79c4.03 1.59 9.63 1 13.01-2.62l-1.81-8.66l-11.4 1.72l-3.24 6.77z"/></g><defs><path id="notoV1Bus0" d="M114 12.21H17.31C7.28 12.21.16 18.34.16 27.36V91.7c0 10.02 8.13 18.15 18.15 18.15h55.67c14.62 0 19.4-1.89 28.34-7.78C111.51 96.02 128 86.02 128 77.82V27.27c0-10.02-3.98-15.06-14-15.06z"/></defs><use fill="#fcc21b" href="#notoV1Bus0"/><clipPath id="notoV1Bus1"><use href="#notoV1Bus0"/></clipPath><path fill="#ed6c30" d="M-.38 82.07h86.33v29.43H-.38zm86.33 35.52l45.37-29.65V54.85L85.95 82.07z" clip-path="url(#notoV1Bus1)"/><defs><path id="notoV1Bus2" d="M80.11 67.23c0 3.36-2.73 6.1-6.1 6.1h-58.6c-3.36 0-6.09-2.74-6.09-6.1V28.49c0-3.36 2.73-6.1 6.09-6.1H74c3.37 0 6.1 2.74 6.1 6.1v38.74z"/></defs><use fill="#40c0e7" href="#notoV1Bus2"/><clipPath id="notoV1Bus3"><use href="#notoV1Bus2"/></clipPath><path fill="#2f2f2f" d="M6.61 20.04h77v17.88h-77z" clip-path="url(#notoV1Bus3)"/><path fill="#fff" d="M20.24 25.96h49.73v8.1H20.24z" clip-path="url(#notoV1Bus3)"/><path fill="#40c0e7" d="M108.42 48.97c0 2.6-1.52 5.56-3.51 6.69l-7.41 4.21c-2.74 1.54-5.13.17-5.13-3.2V29.25c0-3.36 2.4-6.09 5.13-6.09h7.41c1.99 0 3.51 2.11 3.51 4.69v21.12zm11.92-22.19c0-1.97-.73-3.57-1.67-3.57h-3.34c-1.16 0-2.16 1.91-2.16 4.25v19.06c0 2.34 1 3.64 2.16 2.91l3.34-2.04c.94-.58 1.67-2.62 1.67-4.59V26.78z"/><ellipse cx="16.08" cy="93.96" fill="#fff" rx="6.87" ry="6.86"/><path fill="#fff" d="M79.13 93.96c0 3.79-3.08 6.86-6.88 6.86c-3.78 0-6.86-3.07-6.86-6.86c0-3.8 3.07-6.86 6.86-6.86c3.8 0 6.88 3.06 6.88 6.86z"/><path fill="#2f2f2f" d="M102.02 104.14c0 7.85-2.77 14.22-6.17 14.22c-3.41 0-6.18-6.37-6.18-14.22c0-7.86 2.77-14.23 6.18-14.23c3.4.01 6.17 6.37 6.17 14.23zm23.44-16.85c0 7.35-2.05 13.3-4.58 13.3c-2.53 0-4.58-5.95-4.58-13.3s2.05-13.31 4.58-13.31c2.54 0 4.58 5.97 4.58 13.31z"/></svg>
                  }
                  @case ('water') {
                    <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 64 64"><path fill="#e8e8e8" d="M41.4 2c-.7 0-1.3.2-1.9.5c-.6-.3-1.2-.5-1.9-.5c-3.4 0-3.8 2.6-3.8 2.6c-1.6 0-2.8 1.3-2.8 2.8c0 1.6 1.3 2.8 2.8 2.8c.9 0 1.7-.4 2.2-1.1c.5.2 1 .3 1.5.3c.7 0 1.3-.2 1.9-.5c.6.3 1.2.5 1.9.5c2.1 0 3.8-1.7 3.8-3.7S43.4 2 41.4 2m10.3 9.9c-.7 0-1.3.2-1.9.5c-.6-.3-1.2-.5-1.9-.5c-3.4 0-3.8 2.7-3.8 2.7c-1.6 0-2.8 1.3-2.8 2.8c0 1.6 1.3 2.8 2.8 2.8c.9 0 1.7-.4 2.2-1.1c.5.2 1 .3 1.5.3c.7 0 1.3-.2 1.9-.5c.6.3 1.2.5 1.9.5c2.1 0 3.8-1.7 3.8-3.7c0-2.1-1.6-3.8-3.7-3.8"/><path fill="#fff" d="M40.4 18.5v30.3h7.5V18.5c-2.2-2.2-5.2-1.8-7.5 0M29.2 8.2v30.3h7.5V8.2c-2.3-2.2-5.3-1.8-7.5 0"/><path fill="#ed4c5c" d="M29.2 10.1v30.3h7.5V10.1c-2.3-2.2-5.3-1.9-7.5 0"/><path fill="#fff" d="M29.2 11.9v30.3h7.5V11.9c-2.3-2.2-5.3-1.8-7.5 0"/><path fill="#ed4c5c" d="M40.4 20.3v30.3h7.5V20.3c-2.2-2.1-5.2-1.8-7.5 0"/><path fill="#fff" d="M40.4 22.2v30.3h7.5V22.2c-2.2-2.2-5.2-1.8-7.5 0"/><g fill="#94989b"><path d="M58.7 47.8H10.9V23.5l1.9-1.9v-2.7l1.9-1v-2l7.5-3.4l15 2.6l21.5 20.1z"/><path d="M35.2 15.1v3.7l-1.8.4v3.4l-1.9-.2v3.9h-1.8v4.4l29 15.1V35.2L37.2 15.1z"/></g><path fill="#fff" d="M8.6 24.5S3.5 26.3 2 31c0 0 1.6 5.7 6.1 12.6c4.5 6.9 7 16.4 7 16.4V31.7l-6.5-7.2"/><path fill="#3e4347" d="M28.2 27.3v2l-4.9-2.1zm1.9-3.8v1.7l-13.6-1.7zm1.9-3.7v1.7l-13.6-1.7zm1.9-3.8v1.7L20.3 16z"/><path fill="#fff" d="M14.7 14.2V16l7.5-1.8v-1.9z"/><path fill="#e8e8e8" d="M22.2 12.3v1.9l15 1.8v-1.8z"/><path fill="#d0d0d0" d="M37.2 16v-1.8l21.5 21v.5z"/><path fill="#fff" d="M12.8 17.9v1.9l7.5-1.9V16z"/><path fill="#e8e8e8" d="M20.3 16v1.9l15 1.9v-1.9z"/><path fill="#d0d0d0" d="M35.3 19.8v-1.9L58.7 38v.5z"/><path fill="#fff" d="M10.9 21.6v1.9l7.5-1.9v-1.8z"/><path fill="#e8e8e8" d="M18.4 19.8v1.8l15 1.9v-1.9z"/><path fill="#d0d0d0" d="M33.4 23.5v-1.9l25.3 19.2v.5z"/><path fill="#fff" d="M9 25.4v1.9l7.5-1.9v-1.9z"/><path fill="#e8e8e8" d="M16.5 23.5v1.9l15 1.9v-1.9z"/><path fill="#d0d0d0" d="M31.5 27.3v-1.9l27.2 18.2v.5z"/><path fill="#3e4347" d="M57.8 36.9V36L36.2 16.9v1.5zm-.1 2.7v-.9L34.3 20.5v1.4zm.1 3v-.8L32.5 24.1v1.4zM30.6 28.3v1.2l27.2 15.6v-.8z"/><path fill="#d0d0d0" d="M8.6 24.5s-1.1 7.9 2.1 17C15.1 54.1 14.9 60 14.9 60h41.7s.2-2.8 2.8-6.4C62 50 62 47.8 62 47.8S21.1 21.4 8.6 24.5"/><path fill="#3e4347" d="M58.3 46.8L27.4 31.6v2.8l30.9 14z"/><path fill="#e8e8e8" d="M56.6 44.6v2.5h.5v-2.5zM50 40.7v3.1h.5v-3.1zm-7-4.1V41h.5v-4.4zm-8-4V38h.4v-5.4z"/><path fill="#ed4c5c" d="M57.2 47.1c.4.6-.5.7-1.9.4c-1.4-.4-2.9-1.1-3.3-1.7c-.4-.6.5-.7 1.9-.4c1.4.4 2.9 1.1 3.3 1.7m-6.5-3c.4.7-.5.9-2.1.6c-1.6-.4-3.2-1.3-3.6-1.9c-.4-.7.5-.9 2.1-.6c1.6.4 3.2 1.2 3.6 1.9m-7.1-3.3c.5.7-.5 1-2.2.6c-1.7-.3-3.5-1.2-3.9-1.8c-.5-.7.5-1 2.2-.6c1.6.3 3.4 1.2 3.9 1.8m-7.8-3.2c.6.8-.5 1.2-2.5.8c-2-.3-4-1.2-4.6-2c-.6-.8.5-1.2 2.5-.8c1.9.3 4 1.2 4.6 2"/><path fill="#e8e8e8" d="M29 29.6V36h.4v-6.4zm8.5 4.4v5.2h.4V34zm7.8 3.9v4.5h.5v-4.5zm6.9 4.1v3.4h.5V42z"/><path fill="#94989b" d="M5.4 15.9s-.1-1.3 1.8-1.8c0 0 .6-1.6 2.8-1.5c0 0-2.3.9-2.1 2.3c-.1 0-1.7-.4-2.5 1m.4-9s.6-1.1 2.4-.5c0 0 1.4-1.1 3.2.3c0 0-2.4-.5-3 .7c-.1 0-1.2-1.2-2.6-.5"/><path fill="#75d6ff" d="M2 56h60v6H2z"/></svg>
                  }
                  @case ('tram') {
                    <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 64 64"><path fill="#83bf4f" d="M4.8 22.6h54.4v20.6H4.8z"/><path fill="#ffce31" d="M4.8 43.2h54.4V47H4.8z"/><path fill="#3e4347" d="M55.4 18.9H8.6c-2.1 0-3.8 1.7-3.8 3.8h54.4c0-2.1-1.7-3.8-3.8-3.8m-30-3.8h13.1v3.8H25.4zM2 2h60v1.9H2zm21.6 37.8h-9.4V28.5c0-3.3 9.4-3.3 9.4 0v11.3"/><path fill="#b4d7ee" d="M21.7 30.1c0-2.3-5.6-2.3-5.6 0v7.5h5.6v-7.5"/><path fill="#3e4347" d="M12.3 41.7H4.8V25.1s7.5.2 7.5 4.3v12.3"/><path fill="#b4d7ee" d="M10.4 31c0-3.7-5.6-3.6-5.6-3.6v12.1h5.6V31z"/><path fill="#3e4347" d="M34.8 39.8h-9.4V28.5c0-3.3 9.4-3.3 9.4 0v11.3"/><path fill="#b4d7ee" d="M32.9 30.1c0-2.3-5.6-2.3-5.6 0v7.5h5.6v-7.5"/><path fill="#3e4347" d="M46.1 39.8h-9.4V28.5c0-3.3 9.4-3.3 9.4 0v11.3"/><path fill="#b4d7ee" d="M44.2 30.1c0-2.3-5.6-2.3-5.6 0v7.5h5.6v-7.5"/><path fill="#3e4347" d="M57.3 39.8h-9.4V28.5c0-3.3 9.4-3.3 9.4 0v11.3"/><path fill="#b4d7ee" d="M55.4 30.1c0-2.3-5.6-2.3-5.6 0v7.5h5.6v-7.5"/><path fill="#3e4347" d="M5.8 15.5H9v5.6H5.8zm7.7 2h9.1v3.7h-9.1zm30.4-.5H53v3.7h-9.1z"/><path fill="#94989b" d="M2 56.4h60V62H2z"/><path fill="#e6e6e6" d="M2 57.3h60v.9H2z"/><g fill="#3e4347"><path d="m29.953 15.857l5.394-8.774l.767.47l-5.394 8.775zm5.497 1.306l5.399-8.771l1.448.89l-5.4 8.772z"/><path d="m31.795 3.49l.709-.554l7.263 9.3l-.71.553zm3.515-.196l1.418-1.109l5.545 7.09l-1.418 1.108z"/></g><path fill="#699635" d="M4.8 47s-1.9 0-1.9 2.8v3.7h56.3V47H4.8z"/><path fill="#3e4347" d="M2.9 52h56.3v1.6H2.9z"/><path fill="#63686b" d="M18.9 49.8H9.5l-2.8 3.8h15z"/><circle cx="10.9" cy="53.6" r="2.8" fill="#3e4347"/><circle cx="10.9" cy="53.6" r=".9" fill="#94989b"/><circle cx="17.5" cy="53.6" r="2.8" fill="#3e4347"/><circle cx="17.5" cy="53.6" r=".9" fill="#94989b"/><path fill="#63686b" d="M54.5 49.8h-9.4l-2.8 3.8h15z"/><g fill="#3e4347"><circle cx="46.5" cy="53.6" r="2.8"/><circle cx="53.1" cy="53.6" r="2.8"/></g><g fill="#94989b"><circle cx="46.5" cy="53.6" r=".9"/><circle cx="53.1" cy="53.6" r=".9"/></g></svg>
                  }
                }
              </span>
              <span class="">{{ detail.publicCd }}</span>
              
            </div>
            <div class="time-info">
              <div class="planned-time">
                <span>Geplante</span>
                <div class="time-organize">
                  <span>{{detail.locationDetails[0].ttTime | date:'yyyy-MM-dd'}}</span>
                  <span>{{detail.locationDetails[0].ttTime | date:'HH:mm:ss'}}</span>
                </div>
              </div>
              <div class="estimated-time">
                <span>Echt</span>
                
                <div [ngClass]="isDelayed(detail.locationDetails[0])" class="time-organize">
                  <span>{{detail.locationDetails[0].etTime | date:'yyyy-MM-dd'}}</span>
                  <span>{{detail.locationDetails[0].etTime | date:'HH:mm:ss'}}</span>
                </div>
              </div>
              <div class="remaining-time">
                <span class="time-label">Dieses</span>
                <span class="time" [ngClass]="getRemainingTimeClass(detail.locationDetails[0].etTime, now)">
                  {{detail.locationDetails[0].etTime | remainingTime:now }}
                </span>
              </div>
              
              <div class="remaining-time">
                <span class="time-label">Nächstes</span>
                <span class="time">
                  @if(detail.locationDetails.length > 1) {
                    {{ detail.locationDetails[1].etTime | remainingTime:now}}
                  } @else{
                          -
                  }
                </span>
              </div>
            </div>
          </li>
        }
      </ul>
    }
}
